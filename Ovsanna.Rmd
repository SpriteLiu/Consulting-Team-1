---
title: "Ovsanna"
author: "Hsueh-Pin Liu"
date: "`r Sys.Date()`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Environment

```{r}
library(ggplot2)
library(readxl)
data<- read_excel("Daily Monitor Tracking Log.xlsx")
```

#Plots

```{r}
#Two weeks
#1
data1 <- data[c(1:8),]
data1 <- data1[, colSums(is.na(data1)) != nrow(data1)]
data1 <- data1[,-c(1:3)]
x <- rep(NA,8)
data1 <- cbind(data1[,c(1:14)], x, data1[,c(15:22)])
time <- rep(c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"),8)
point <- c(t(as.matrix(data1)))
type <- rep(c("P1","P2","P3","P4","P5","P6","P7","P8"),each=23)
df <- data.frame(time=time,point=point,type=type)
df$time <- factor(df$time,levels=c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"))
ggplot(data=df,mapping=aes(x=time,y=point,group=type,colour=type))+geom_line()+geom_point()+theme(axis.text.x=element_text(angle=45))+scale_y_continuous(limits = c(0, 8))+ggtitle("ID=1, Randomization=2")+facet_wrap(~type)+geom_vline(xintercept=15)

#2

data2 <- data[c(17:24),]
data2 <- data2[, colSums(is.na(data2)) != nrow(data2)]
data2 <- data2[,-c(1:3)]
x <- rep(NA,8)
data2 <- cbind(data2[,c(1:14)], x, data2[,c(15:22)])
time <- rep(c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"),8)
point <- c(t(as.matrix(data2)))
type <- rep(c("P1","P2","P3","P4","P5","P6","P7","P8"),each=23)
df <- data.frame(time=time,point=point,type=type)
df$time <- factor(df$time,levels=c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"))
ggplot(data=df,mapping=aes(x=time,y=point,group=type,colour=type))+geom_line()+geom_point()+theme(axis.text.x=element_text(angle=45))+scale_y_continuous(limits = c(0, 8))+ggtitle("ID=3, Randomization=2")+facet_wrap(~type)+geom_vline(xintercept=15)
```
```{r}
#Three weeks
#3
data3 <- data[c(9:16),]
data3 <- data3[, colSums(is.na(data3)) != nrow(data3)]
data3 <- data3[,-c(1:3)]
x <- rep(NA,8)
data3 <- cbind(data3[,c(1:21)], x, data3[,c(22:29)])
time <- rep(c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"),8)
point <- c(t(as.matrix(data3)))
type <- rep(c("P1","P2","P3","P4","P5","P6","P7","P8"),each=30)
df <- data.frame(time=time,point=point,type=type)
df$time <- factor(df$time,levels=c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"))
ggplot(data=df,mapping=aes(x=time,y=point,group=type,colour=type))+geom_line()+geom_point()+theme(axis.text.x=element_text(angle=45))+scale_y_continuous(limits = c(0, 8))+ggtitle("ID=5, Randomization=3")+facet_wrap(~type)+geom_vline(xintercept=22)

#4
data4 <- data[c(33:40),]
data4 <- data4[, colSums(is.na(data4)) != nrow(data4)]
data4 <- data4[,-c(1:3)]
x <- rep(NA,8)
data4 <- cbind(data4[,c(1:21)], x, data4[,c(22:29)])
time <- rep(c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"),8)
point <- c(t(as.matrix(data4)))
type <- rep(c("P1","P2","P3","P4","P5","P6","P7","P8"),each=30)
df <- data.frame(time=time,point=point,type=type)
df$time <- factor(df$time,levels=c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"))
ggplot(data=df,mapping=aes(x=time,y=point,group=type,colour=type))+geom_line()+geom_point()+theme(axis.text.x=element_text(angle=45))+scale_y_continuous(limits = c(0, 8))+ggtitle("ID=9, Randomization=3")+facet_wrap(~type)+geom_vline(xintercept=22)

#5
data5 <- data[c(41:48),]
data5 <- data5[, colSums(is.na(data5)) != nrow(data5)]
data5 <- data5[,-c(1:3)]
x <- rep(NA,8)
data5 <- cbind(data5[,c(1:21)], x, data5[,c(22:29)])
time <- rep(c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"),8)
point <- c(t(as.matrix(data5)))
type <- rep(c("P1","P2","P3","P4","P5","P6","P7","P8"),each=30)
df <- data.frame(time=time,point=point,type=type)
df$time <- factor(df$time,levels=c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"))
ggplot(data=df,mapping=aes(x=time,y=point,group=type,colour=type))+geom_line()+geom_point()+theme(axis.text.x=element_text(angle=45))+scale_y_continuous(limits = c(0, 8))+ggtitle("ID=12, Randomization=3")+facet_wrap(~type)+geom_vline(xintercept=22)

#6
data6 <- data[c(57:64),]
data6 <- data6[, colSums(is.na(data6)) != nrow(data6)]
data6 <- data6[,-c(1:3)]
x <- rep(NA,8)
data6 <- cbind(data6[,c(1:21)], x, data6[,c(22:29)])
time <- rep(c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"),8)
point <- c(t(as.matrix(data6)))
type <- rep(c("P1","P2","P3","P4","P5","P6","P7","P8"),each=30)
df <- data.frame(time=time,point=point,type=type)
df$time <- factor(df$time,levels=c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"))
ggplot(data=df,mapping=aes(x=time,y=point,group=type,colour=type))+geom_line()+geom_point()+theme(axis.text.x=element_text(angle=45))+scale_y_continuous(limits = c(0, 8))+ggtitle("ID=17, Randomization=3")+facet_wrap(~type)+geom_vline(xintercept=22)
```

```{r}
#Four weeks
#7
data7 <- data[c(25:32),]
data7 <- data7[, colSums(is.na(data7)) != nrow(data7)]
data7 <- data7[,-c(1:3)]
x <- rep(NA,8)
data7 <- cbind(data7[,c(1:28)], x, data7[,c(29:36)])
time <- rep(c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","W4D1","W4D2","W4D3","W4D4","W4D5","W4D6","W4D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"),8)
point <- c(t(as.matrix(data7)))
type <- rep(c("P1","P2","P3","P4","P5","P6","P7","P8"),each=37)
df <- data.frame(time=time,point=point,type=type)
df$time <- factor(df$time,levels=c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","W4D1","W4D2","W4D3","W4D4","W4D5","W4D6","W4D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"))
ggplot(data=df,mapping=aes(x=time,y=point,group=type,colour=type))+geom_line()+geom_point()+theme(axis.text.x=element_text(angle=45))+scale_y_continuous(limits = c(0, 8))+ggtitle("ID=6, Randomization=4")+facet_wrap(~type)+geom_vline(xintercept=29)

#8
data8 <- data[c(49:56),]
data8 <- data8[,-c(1:3)]
x <- rep(NA,8)
data8 <- cbind(data8[,c(1:28)], x, data8[,c(29:36)])
time <- rep(c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","W4D1","W4D2","W4D3","W4D4","W4D5","W4D6","W4D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"),8)
point <- c(t(as.matrix(data8)))
type <- rep(c("P1","P2","P3","P4","P5","P6","P7","P8"),each=37)
df <- data.frame(time=time,point=point,type=type)
df$time <- factor(df$time,levels=c("W1D1","W1D2","W1D3","W1D4","W1D5","W1D6","W1D7","W2D1","W2D2","W2D3","W2D4","W2D5","W2D6","W2D7","W3D1","W3D2","W3D3","W3D4","W3D5","W3D6","W3D7","W4D1","W4D2","W4D3","W4D4","W4D5","W4D6","W4D7","Split","TrD1","TrD2","TrD3","TrD4","TrD5","TrD6","TrD7","TrD8"))
ggplot(data=df,mapping=aes(x=time,y=point,group=type,colour=type))+geom_line()+geom_point()+theme(axis.text.x=element_text(angle=45))+scale_y_continuous(limits = c(0, 8))+ggtitle("ID=11, Randomization=4")+facet_wrap(~type)+geom_vline(xintercept=29)

```


```{r}
library(dplyr)
#Choose problem
newdata <- data[which(data$Problem=="Average Anxiety Today"),]
newdata <- newdata[,-c(1:3)]
p <- as.matrix(newdata)
y <- c(t(p))
y <- y[!is.na(y)] 
t <- c(1:22,1:29,1:22,1:36,1:29,1:29,1:35,1:29)
T <- c(rep(0,14),rep(1,8),rep(0,21),rep(1,8),rep(0,14),rep(1,8),rep(0,28),rep(1,8),rep(0,21),rep(1,8),rep(0,21),rep(1,8),rep(0,28),rep(1,7),rep(0,21),rep(1,8))
ID <- c(rep(1,22),rep(5,29),rep(3,22),rep(6,36),rep(9,29),rep(12,29),rep(11,35),rep(17,29))
m <- data.frame(y,ID,t,T)z
```

